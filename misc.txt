select Product.ProductName, Sales.ProductID, Count(*) as "popularity", week(Sales.DateofSale) from Product, Sales where Sales.ProductID = Product.ProductID and week(DateofSale) = week(curdate())-1 and year(Dateofsale) = year(curdate()) group by week(DateofSale), Sales.ProductID having count(*) = (select max(r) from (select count(*) as r, ProductID from Sales where week(Dateofsale) = week(curdate())-1 and year(Dateofsale) = year(curdate()) group by DateofSale, ProductID) as myTable); 
